/*********************************************************************

Jackson Philion, Oct.7.2024, jphilion@g.hmc.edu
For E155 Lab 4, Harvey Mudd College, taught by Prof Josh Brake.

This file 

*********************************************************************/


#include <stdio.h>
#include "e155_lab4.h"

// lab4_starter.c
// Fur Elise, E155 Lab 4
// Updated Fall 2024

// Pitch in Hz, duration in ms
const int notes[][2] = {
{659,	125},
{623,	125},
{659,	125},
{623,	125},
{659,	125},
{494,	125},
{587,	125},
{523,	125},
{440,	250},
{  0,	125},
{262,	125},
{330,	125},
{440,	125},
{494,	250},
{  0,	125},
{330,	125},
{416,	125},
{494,	125},
{523,	250},
{  0,	125},
{330,	125},
{659,	125},
{623,	125},
{659,	125},
{623,	125},
{659,	125},
{494,	125},
{587,	125},
{523,	125},
{440,	250},
{  0,	125},
{262,	125},
{330,	125},
{440,	125},
{494,	250},
{  0,	125},
{330,	125},
{523,	125},
{494,	125},
{440,	250},
{  0,	125},
{494,	125},
{523,	125},
{587,	125},
{659,	375},
{392,	125},
{699,	125},
{659,	125},
{587,	375},
{349,	125},
{659,	125},
{587,	125},
{523,	375},
{330,	125},
{587,	125},
{523,	125},
{494,	250},
{  0,	125},
{330,	125},
{659,	125},
{  0,	250},
{659,	125},
{1319,	125},
{  0,	250},
{623,	125},
{659,	125},
{  0,	250},
{623,	125},
{659,	125},
{623,	125},
{659,	125},
{623,	125},
{659,	125},
{494,	125},
{587,	125},
{523,	125},
{440,	250},
{  0,	125},
{262,	125},
{330,	125},
{440,	125},
{494,	250},
{  0,	125},
{330,	125},
{416,	125},
{494,	125},
{523,	250},
{  0,	125},
{330,	125},
{659,	125},
{623,	125},
{659,	125},
{623,	125},
{659,	125},
{494,	125},
{587,	125},
{523,	125},
{440,	250},
{  0,	125},
{262,	125},
{330,	125},
{440,	125},
{494,	250},
{  0,	125},
{330,	125},
{523,	125},
{494,	125},
{440,	500},
{  0,	0}};

/********************************************************
NOTE: I had to comment out line 198 of System Files > STM32L4xx_Startup.s
********************************************************/

void playSong(int songArray[][2]){
    /* This function takes in an array representing a song. The array should be formatted:
    {  {freq0,milSec0}, {freq1,milSec1}, etc. } */
    
    // Start Clock, with built in PLL enable
    configureClock();



    // Enable PWM output on Pin PA5 (defined in the function)
    pinOutputPWM();
    int j = 0;
    while (songArray[j][1]!=0) {
        playNote(songArray[j][0], songArray[j][1]);
        j++;
    }
}

int main(void) {
    playSong(notes);
}

/*************************** End of file ****************************/
